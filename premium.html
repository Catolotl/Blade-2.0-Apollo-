<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Indy Sunrise AI</title>
  <link rel="shortcut icon" type="image/png" href="favicon.png">
  
<style>
    :root {
      --bg:            #000000;
      --bg-dark:       #0a0a0a;
      --bg-darker:     #111111;
      --text:          #e8e8e8;
      --text-dim:      #a0a0a0;
      --text-ghost:    #606060;
      --border:        1px solid #1a1a1a;
      --glass:         rgba(20,20,20,0.45);
      --blur:          blur(16px);
      --radius:        16px;
      --spacing:       24px;
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: system-ui, -apple-system, sans-serif;
      min-height: 100vh;
      display: flex;
    }

    /* â”€â”€ Sidebar â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .sidebar {
      position: fixed;
      inset: 0 auto 0 0;
      width: 280px;
      background: var(--bg-dark);
      border-right: var(--border);
      display: flex;
      flex-direction: column;
      transition: width 0.4s cubic-bezier(0.25,0.1,0.25,1);
      z-index: 100;
      overflow: hidden;
    }
    .sidebar.collapsed { width: 72px; }

    .header {
      padding: 20px 24px;
      display: flex;
      align-items: center;
      gap: 16px;
      min-height: 68px;
      flex-shrink: 0;
    }

    .menu-btn {
      background: none;
      border: none;
      color: var(--text-dim);
      font-size: 24px;
      cursor: pointer;
      padding: 8px;
      border-radius: 12px;
      transition: all 0.2s;
    }
    .menu-btn:hover { background: var(--bg-darker); color: var(--text); }

    .title {
      font-size: 26px;
      font-weight: 700;
      letter-spacing: -0.02em;
      color: var(--text);
      white-space: nowrap;
    }
    .sidebar.collapsed .title { font-size: 32px; }

    .sidebar-content {
      flex: 1;
      padding: 16px;
      overflow-y: auto;
    }

    .sidebar-btn {
      width: 100%;
      height: 52px;
      background: transparent;
      border: none;
      border-radius: 14px;
      color: var(--text-dim);
      font-size: 0; /* hide text when collapsed */
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }
    .sidebar-btn:not(.collapsed-visible) span { display: none; }
    .sidebar.collapsed .sidebar-btn span { display: none; }
    .sidebar-btn:hover { background: var(--glass); backdrop-filter: var(--blur); color: var(--text); }

    .sidebar-btn::before {
      content: attr(data-icon);
      font-size: 22px;
      opacity: 0.7;
    }
    .sidebar-btn:hover::before { opacity: 1; }

    /* Add icons via data-attribute */
    [data-action="new"]::before    { content: "âœ¦"; }
    [data-action="projects"]::before { content: "ðŸ—‚"; }
    [data-action="profile"]::before  { content: "ðŸ‘¤"; }
    [data-action="delete"]::before   { content: "ðŸ—‘"; }

    /* â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .main {
      flex: 1;
      margin-left: 280px;
      display: flex;
      flex-direction: column;
      transition: margin-left 0.4s cubic-bezier(0.25,0.1,0.25,1);
    }
    .sidebar.collapsed ~ .main { margin-left: 72px; }

    .chat-container {
      flex: 1;
      overflow-y: auto;
      padding: var(--spacing) var(--spacing) 120px;
      display: flex;
      flex-direction: column;
      gap: 32px;
    }

    /* Messages â”€â”€ user tiny, AI invisible */
    .message {
      max-width: 78%;
      margin: 2px 0;
    }
    .user {
      align-self: flex-end;
      text-align: right;
    }
    .bot {
      align-self: flex-start;
    }

    .bubble {
      padding: 10px 16px;
      border-radius: 16px;
      line-height: 1.5;
      font-size: 16px;
      position: relative;
    }

    .user .bubble {
      background: var(--glass);
      backdrop-filter: var(--blur);
      border: 1px solid rgba(255,255,255,0.08);
      color: var(--text);
      border-bottom-right-radius: 4px;
      max-width: 420px;
      display: inline-block;
    }

    .bot .bubble {
      background: transparent;
      border: none;
      box-shadow: none;
      padding: 0;
      color: var(--text);
      font-size: 17px;
      line-height: 1.65;
    }

    /* Copy button â€“ only on bot */
    .copy-btn {
      position: absolute;
      top: 8px; right: 8px;
      background: rgba(255,255,255,0.06);
      border: none;
      color: var(--text-dim);
      font-size: 12px;
      padding: 4px 8px;
      border-radius: 8px;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
    }
    .bot:hover .copy-btn { opacity: 0.7; }
    .copy-btn:hover { opacity: 1; background: rgba(255,255,255,0.12); }

    /* Input â”€â”€ floating glass pill */
    .input-area {
      padding: 24px var(--spacing);
      background: var(--bg);
      border-top: var(--border);
      position: sticky;
      bottom: 0;
      z-index: 10;
    }
    .input-wrapper {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      gap: 12px;
      align-items: center;
      background: var(--glass);
      backdrop-filter: var(--blur);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 999px;
      padding: 8px 16px;
    }
    #userInput {
      flex: 1;
      background: transparent;
      border: none;
      color: var(--text);
      font-size: 17px;
      outline: none;
      padding: 12px 0;
    }
    #userInput::placeholder { color: var(--text-dim); }

    .send-btn {
      width: 44px;
      height: 44px;
      background: var(--text-dim);
      color: var(--bg);
      border: none;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .send-btn:hover { background: var(--text); transform: scale(1.08); }

    /* Typing */
    .typing-indicator {
      display: inline-flex;
      gap: 6px;
      padding: 4px 0;
    }
    .typing-indicator span {
      width: 8px; height: 8px;
      background: var(--text-dim);
      border-radius: 50%;
      animation: typingBounce 1.4s infinite ease-in-out;
    }
    @keyframes typingBounce {
      0%, 60%, 100% { transform: translateY(0); opacity: 0.5; }
      30% { transform: translateY(-10px); opacity: 1; }
    }

    /* Modals */
    .teach-modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(20px);
    }
    .teach-modal.active { display: flex; }

    .teach-content {
      background: var(--glass);
      backdrop-filter: var(--blur);
      border: 1px solid rgba(255,255,255,0.08);
      border-radius: 24px;
      padding: 32px;
      max-width: 520px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.6);
      position: relative;
    }

    .close-btn {
      position: absolute;
      top: 20px; right: 20px;
      background: rgba(255,255,255,0.08);
      border: none;
      color: var(--text-dim);
      font-size: 28px;
      cursor: pointer;
      width: 40px; height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    .close-btn:hover { background: rgba(255,255,255,0.15); color: white; }
  </style>
</head>
<body>
  <div class="sidebar" id="sidebar">
    <div class="header">
      <button class="menu-btn" onclick="toggleSidebar()">â˜°</button>
      <div class="title-wrapper">
        <div class="title" id="sidebarTitle">Indy/</div>
      </div>
    </div>
    <div class="sidebar-content">
      <button class="sidebar-btn" onclick="newChat()">New Chat</button>
      <button class="sidebar-btn" onclick="openProjects()">Projects</button>
      <button class="sidebar-btn" onclick="openProfile()">Profile Settings</button>
      <button class="sidebar-btn danger" onclick="deleteAllChats()">Delete Everything</button>
      <hr>
      <div id="chatList"></div>
    </div>
  </div>

  <div class="main">
    <div class="chat-container" id="chatMessages">
      <div class="message bot">
        <div class="bubble">
          How's it going! I'm Indy,<br>
          Ready when you are!
        </div>
      </div>
    </div>

    <div class="input-area">
      <div class="input-wrapper">
        <input type="text" id="userInput" placeholder="Ask Anything" onkeypress="if(event.key==='Enter') sendMessage()">
        <button class="send-btn" onclick="sendMessage()">â†‘</button>
      </div>
    </div>
  </div>

  <!-- Teach Modal (kept but simplified) -->
  <div class="teach-modal" id="teachModal">
    <div class="teach-content">
      <button class="close-btn" onclick="closeTeachModal()">Ã—</button>
      <h2>Teach Indy</h2>
      <div class="teach-input-group">
        <label>Trigger Phrase</label>
        <input type="text" id="triggerInput" placeholder="e.g. What's your favorite color?">
      </div>
      <div class="teach-input-group">
        <label>Response</label>
        <textarea id="responseInput" placeholder="e.g. My favorite color is blue!"></textarea>
      </div>
      <button class="teach-submit-btn" onclick="submitTeaching()">Teach Indy</button>
    </div>
  </div>

  <!-- Profile Modal -->
  <div class="teach-modal" id="profileModal">
    <div class="teach-content">
      <button class="close-btn" onclick="closeProfileModal()">Ã—</button>
      <h2>Profile Settings</h2>
      <div style="display:flex;justify-content:center;margin-bottom:20px;">
        <div id="profilePreview" style="width:100px;height:100px;border-radius:50%;background:#282828;background-size:cover;background-position:center;"></div>
      </div>
      <div class="teach-input-group">
        <label>Your Name</label>
        <input type="text" id="profileName" placeholder="e.g. Alex">
      </div>
      <div class="teach-input-group">
        <label>Profile Picture URL</label>
        <input type="text" id="profilePicture" placeholder="https://example.com/image.jpg" oninput="updateProfilePreview()">
      </div>
      <button class="teach-submit-btn" onclick="submitProfile()">Save Profile</button>
    </div>
  </div>

  <script>
let knowledge = [];
    let personality = "";
    let currentChatId = null;
    let userProfile = JSON.parse(localStorage.getItem('userProfile')) || { name: '', picture: '' };

    function toggleSidebar() {
      document.getElementById('sidebar').classList.toggle('collapsed');
    }

function saveCurrentChat() {
  if (!currentChatId) return;
  const messages = [];
  document.querySelectorAll('#chatMessages .message').forEach(msg => {
    const sender = msg.classList.contains('user') ? 'user' : 'bot';
    const text = msg.querySelector('.bubble').textContent.replace('Copy', '').trim();
    messages.push({ sender, text });
  });
  const chatData = {
    id: currentChatId,
    name: getChatName(currentChatId),
    messages,
    lastUpdated: Date.now()
  };
  localStorage.setItem(`chat_${currentChatId}`, JSON.stringify(chatData));
}

async function generateChatName(firstMessage) {
  try {
    const prompt = `Generate a short, concise chat title (3-5 words max) for a conversation that starts with: "${firstMessage}". Only respond with the title, nothing else.`;
    const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}`);
    if (res.ok) {
      const name = await res.text();
      return name.trim().replace(/['"]/g, '').substring(0, 40);
    }
  } catch {}
  return `Chat ${Date.now()}`;
}

function loadChat(chatId) {
  const chatData = JSON.parse(localStorage.getItem(`chat_${chatId}`));
  if (!chatData) return;
  currentChatId = chatId;
  document.getElementById('chatMessages').innerHTML = '';
  chatData.messages.forEach(msg => addMessage(msg.sender, msg.text, false));
}

async function newChat(chatId = null) {
  if (chatId) {
    loadChat(chatId);
    return;
  }
  currentChatId = `chat_${Date.now()}`;
  document.getElementById('chatMessages').innerHTML = '';
  addMessage('bot', `Ready when you are!`, false);
  const chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
  chatList.unshift({ id: currentChatId, name: 'New Chat' });
  localStorage.setItem('chatList', JSON.stringify(chatList));
  saveCurrentChat();
  loadSavedChats();
}

async function updateChatName(chatId, firstMessage) {
  const generatedName = await generateChatName(firstMessage);
  const chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
  const chat = chatList.find(c => c.id === chatId);
  if (chat && chat.name === 'New Chat') {
    chat.name = generatedName;
    localStorage.setItem('chatList', JSON.stringify(chatList));
    const chatData = JSON.parse(localStorage.getItem(`chat_${chatId}`));
    if (chatData) {
      chatData.name = generatedName;
      localStorage.setItem(`chat_${chatId}`, JSON.stringify(chatData));
    }
    loadSavedChats();
  }
}

function getChatName(chatId) {
  const chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
  const chat = chatList.find(c => c.id === chatId);
  return chat ? chat.name : 'Unnamed Chat';
}

function deleteChat(chatId) {
  localStorage.removeItem(`chat_${chatId}`);
  let chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
  chatList = chatList.filter(c => c.id !== chatId);
  localStorage.setItem('chatList', JSON.stringify(chatList));
  if (currentChatId === chatId) {
    currentChatId = null;
    document.getElementById('chatMessages').innerHTML = '';
    addMessage('bot', `Ready when you are!`, false);
  }
  loadSavedChats();
}

function deleteAllChats() {
  if (confirm("Delete all saved chats and history permanently?")) {
    const chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
    chatList.forEach(chat => localStorage.removeItem(`chat_${chat.id}`));
    localStorage.removeItem('chatList');
    knowledge = [];
    currentChatId = null;
    document.getElementById('chatMessages').innerHTML = '';
    addMessage('bot', `All chats deleted! Ready for a fresh start!`, false);
    loadSavedChats();
  }
}

function teachAI() {
  document.getElementById('teachModal').classList.add('active');
  document.getElementById('triggerInput').value = '';
  document.getElementById('responseInput').value = '';
  document.getElementById('triggerInput').focus();
}

function closeTeachModal() {
  document.getElementById('teachModal').classList.remove('active');
}

function submitTeaching() {
  const q = document.getElementById('triggerInput').value.trim();
  const a = document.getElementById('responseInput').value.trim();
  if (!q || !a) { alert('Please fill in both fields!'); return; }
  let found = false;
  for (const entry of knowledge) {
    if (entry.answer.toLowerCase() === a.toLowerCase()) {
      entry.questions.push(q);
      found = true;
      break;
    }
  }
  if (!found) knowledge.push({ questions: [q], answer: a });
  addMessage('bot', "Learned! I'll remember that.");
  closeTeachModal();
}

function openProfile() {
  document.getElementById('profileModal').classList.add('active');
  document.getElementById('profileName').value = userProfile.name;
  document.getElementById('profilePicture').value = userProfile.picture;
  updateProfilePreview();
}

function closeProfileModal() {
  document.getElementById('profileModal').classList.remove('active');
}

function updateProfilePreview() {
  const preview = document.getElementById('profilePreview');
  const pictureUrl = document.getElementById('profilePicture').value.trim();
  preview.style.backgroundImage = pictureUrl ? `url(${pictureUrl})` : 'none';
  preview.style.backgroundColor = pictureUrl ? 'transparent' : '#282828';
}

function submitProfile() {
  userProfile.name = document.getElementById('profileName').value.trim();
  userProfile.picture = document.getElementById('profilePicture').value.trim();
  localStorage.setItem('userProfile', JSON.stringify(userProfile));
  closeProfileModal();
}

function openProjects() {
  alert("Projects view coming soon! You can later expand this to show saved projects or canvases.");
}

// â”€â”€ Rest of your script remains 100% functional â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function cosineSimilarity(a, b) {
  const tokensA = a.toLowerCase().match(/\w+/g) || [];
  const tokensB = b.toLowerCase().match(/\w+/g) || [];
  const set = [...new Set([...tokensA, ...tokensB])];
  const vecA = set.map(t => tokensA.filter(w => w === t).length);
  const vecB = set.map(t => tokensB.filter(w => w === t).length);
  let dot = 0, normA = 0, normB = 0;
  for (let i = 0; i < set.length; i++) {
    dot += vecA[i] * vecB[i];
    normA += vecA[i] ** 2;
    normB += vecB[i] ** 2;
  }
  return normA && normB ? dot / (Math.sqrt(normA) * Math.sqrt(normB)) : 0;
}

function findInKnowledge(msg) {
  let best = null, bestScore = 0;
  for (const entry of knowledge) {
    for (const q of entry.questions) {
      const score = cosineSimilarity(msg, q);
      if (score > bestScore && score > 0.5) {
        bestScore = score;
        best = entry.answer;
      }
    }
  }
  return best;
}

function handleMath(msg) {
  const expr = msg.toLowerCase().replace(/^(what is|calculate|\s)+/g, '').trim()
    .replace(/Ã—/g,'*').replace(/Ã·/g,'/').replace(/\^/g,'**');
  if (/^[0-9+\-*/().\s**]+$/.test(expr)) {
    try { return Function('"use strict"; return (' + expr + ')')(); } catch(e) {}
  }
  return null;
}

async function getDefinition(word) {
  try {
    const res = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
    const data = await res.json();
    if (!data.title) return `**${word}:** ${data[0].meanings[0].definitions[0].definition}`;
  } catch {}
  return null;
}

async function getWikipedia(topic) {
  try {
    const res = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(topic)}`);
    const data = await res.json();
    if (data.extract) return `**${data.title}:** ${data.extract}`;
  } catch {}
  return null;
}

async function getAIResponse(prompt) {
  const fullPrompt = getSystemPrompt() + prompt;
  try {
    const res = await fetch(`https://text.pollinations.ai/${encodeURIComponent(fullPrompt)}`);
    if (res.ok) {
      const text = await res.text();
      return text.trim() || "â€¦";
    }
  } catch {}
  return "Thinking took too long.";
}

async function generateImage(prompt) {
  try {
    const encoded = encodeURIComponent(prompt.trim());
    const url = `https://image.pollinations.ai/prompt/${encoded}?model=flux&width=1152&height=896&nologo=true&safe=true`;
    const head = await fetch(url, { method: 'HEAD' });
    if (!head.ok) throw new Error(`Pollinations responded ${head.status}`);
    return url;
  } catch (err) {
    console.error("Image gen error:", err);
    return `Error generating image: ${err.message}. Try again in a few seconds.`;
  }
}

async function sendMessage() {
  const input = document.getElementById('userInput');
  const msg = input.value.trim();
  if (!msg) return;

  if (!currentChatId) {
    currentChatId = `chat_${Date.now()}`;
    const chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
    chatList.unshift({ id: currentChatId, name: 'New Chat' });
    localStorage.setItem('chatList', JSON.stringify(chatList));
  }

  addMessage('user', msg);
  input.value = '';

  const messageCount = document.querySelectorAll('#chatMessages .message.user').length;
  if (messageCount === 1) {
    updateChatName(currentChatId, msg);
  }

  const learned = findInKnowledge(msg);
  if (learned) {
    addMessage('bot', learned);
    saveCurrentChat();
    return;
  }

  if (/^define |^meaning of /.test(msg.toLowerCase())) {
    const word = msg.replace(/^define |^meaning of /i, '').trim().split(' ')[0];
    addTypingIndicator();
    const def = await getDefinition(word);
    replaceLastBot(def || "Not found.");
    saveCurrentChat();
    return;
  }

  if (/^tell me about |^what is /.test(msg.toLowerCase())) {
    const topic = msg.replace(/^tell me about |^what is /i, '').trim();
    addTypingIndicator();
    const wiki = await getWikipedia(topic);
    replaceLastBot(wiki || "No result.");
    saveCurrentChat();
    return;
  }

  const math = handleMath(msg);
  if (math !== null) {
    addMessage('bot', `**${msg} = ${math}**`);
    saveCurrentChat();
    return;
  }

  if (msg.toLowerCase().startsWith('!img ') ||
      msg.toLowerCase().startsWith('generate image ') ||
      msg.toLowerCase().startsWith('draw ') ||
      msg.toLowerCase().startsWith('create image ')) {
    const imagePrompt = msg
      .replace(/^!img /i, '')
      .replace(/^generate image /i, '')
      .replace(/^draw /i, '')
      .replace(/^create image /i, '')
      .trim();

    if (!imagePrompt) {
      addMessage('bot', "Add a description please!\nExample: `!img neon cyberpunk fox in tokyo rain`");
      saveCurrentChat();
      return;
    }

    addTypingIndicator();
    const result = await generateImage(imagePrompt);

    if (result.startsWith('http')) {
      replaceLastBot(
        `Hereâ€™s your Flux image:\n\n` +
        `<img src="${result}" alt="${imagePrompt}" ` +
        `style="max-width:100%; border-radius:20px; margin:16px 0; box-shadow:0 8px 32px rgba(0,0,0,0.5);">` +
        `\n\n**Prompt:** ${imagePrompt}\n` +
        `(Powered by pollinations.ai â€“ free & no login)`
      );
    } else {
      replaceLastBot(result);
    }
    saveCurrentChat();
    return;
  }

  addTypingIndicator();
  const response = await getAIResponse(msg);
  replaceLastBot(response);
  saveCurrentChat();
}

function addMessage(sender, text, shouldSave = true) {
  const container = document.getElementById('chatMessages');
  const msgDiv = document.createElement('div');
  msgDiv.className = `message ${sender}`;
  if (sender === 'bot') {
    msgDiv.innerHTML = `
      <div class="bubble">
        ${text.replace(/\n/g, '<br>')}
        <button class="copy-btn" onclick="copyText(this)">Copy</button>
      </div>`;
  } else {
    msgDiv.innerHTML = `<div class="bubble">${text.replace(/\n/g, '<br>')}</div>`;
  }
  container.appendChild(msgDiv);
  container.scrollTop = container.scrollHeight;
  if (shouldSave) saveCurrentChat();
}

function addTypingIndicator() {
  const container = document.getElementById('chatMessages');
  const msgDiv = document.createElement('div');
  msgDiv.className = 'message bot';
  msgDiv.innerHTML = `
    <div class="bubble">
      <div class="typing-indicator">
        <span></span><span></span><span></span>
      </div>
    </div>`;
  container.appendChild(msgDiv);
  container.scrollTop = container.scrollHeight;
}

function replaceLastBot(text) {
  const lastBotBubble = document.querySelector('.message.bot:last-child .bubble');
  if (lastBotBubble) {
    lastBotBubble.innerHTML = text.replace(/\n/g, '<br>') +
      '<button class="copy-btn" onclick="copyText(this)">Copy</button>';
  }
  document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
  saveCurrentChat();
}

function copyText(btn) {
  const bubble = btn.parentElement;
  const text = bubble.textContent.replace('Copy', '').trim();
  navigator.clipboard.writeText(text);
  btn.textContent = 'Copied';
  setTimeout(() => btn.textContent = 'Copy', 2000);
}

function loadSavedChats() {
  const chatList = document.getElementById('chatList');
  chatList.innerHTML = '';
  const chats = JSON.parse(localStorage.getItem('chatList') || '[]');
  chats.forEach(chat => createChatButton(chat.id, chat.name));
}

function createChatButton(chatId, name) {
  const chatList = document.getElementById('chatList');
  const btn = document.createElement('button');
  btn.className = 'sidebar-btn';
  btn.style.display = 'flex';
  btn.style.justifyContent = 'space-between';
  btn.style.alignItems = 'center';
  btn.textContent = name;
  btn.onclick = () => newChat(chatId);
  const delBtn = document.createElement('span');
  delBtn.textContent = 'âœ•';
  delBtn.style.marginLeft = '8px';
  delBtn.style.cursor = 'pointer';
  delBtn.style.color = '#ff3b30';
  delBtn.onclick = (e) => {
    e.stopPropagation();
    deleteChat(chatId);
  };
  btn.appendChild(delBtn);
  chatList.appendChild(btn);
}

// Init
window.addEventListener('DOMContentLoaded', () => {
  document.getElementById('sidebar').classList.add('collapsed');
  loadSavedChats();
  const chatList = JSON.parse(localStorage.getItem('chatList') || '[]');
  if (chatList.length > 0) {
    loadChat(chatList[0].id);
  } else {
    addMessage('bot', `Ready when you are!`, false);
  }
});
  </script>
</body>
</html>
